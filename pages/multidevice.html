<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Hitler - Multi-Device Setup</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/themes.css">
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        .multi-device-setup {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .setup-section {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            transition: all 0.3s ease;
            box-shadow: var(--card-shadow);
        }
        
        .setup-section:hover {
            box-shadow: 0 4px 16px var(--shadow-medium);
            border-color: var(--primary-color);
        }
        
        .role-distribution, .enhanced-section {
            transition: all 0.3s ease;
        }
        
        .game-creation, .game-joining {
            display: none;
        }
        
        .game-creation.active, .game-joining.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--input-text);
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--shadow-light);
            transform: translateY(-1px);
        }
        
        .form-group select {
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 8px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }
        
        .form-help {
            display: block;
            margin-top: 5px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }
        
        .form-group select:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: var(--bg-tertiary);
            color: var(--text-muted);
        }
        
        .form-group select:disabled + .form-help {
            color: var(--accent-danger);
        }
        
        .form-group select:disabled option {
            color: var(--text-muted);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .btn:disabled:hover {
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* Loading state for the select dropdown */
        .form-group.loading select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15'/%3e%3c/svg%3e");
            background-size: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .game-lobby {
            display: none;
        }
        
        .game-lobby.active {
            display: block;
        }
        
        .players-list {
            margin: 20px 0;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin: 5px 0;
        }
        
        .player-host {
            background: var(--accent-color);
            color: white;
        }
        
        .game-id-display {
            background: var(--highlight-bg);
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            text-align: center;
            font-family: monospace;
            font-size: 18px;
        }
        
        .status-message {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .status-success {
            background: var(--success-bg);
            color: var(--success-color);
            border: 1px solid var(--success-border);
        }
        
        .status-error {
            background: var(--error-bg);
            color: var(--error-color);
            border: 1px solid var(--error-border);
        }
        
        .status-info {
            background: var(--info-bg);
            color: var(--info-color);
            border: 1px solid var(--info-border);
        }
        


        /* Pass-and-play style player count selector */
        .player-count-selector {
            margin: 20px 0;
        }

        .player-count-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .player-btn {
            width: 3rem;
            height: 3rem;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-primary);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: var(--card-shadow);
        }
        
        .player-btn:hover:not(:disabled) {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: var(--text-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-medium);
        }
        
        .player-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        .player-count-display {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            text-align: center;
            min-width: 120px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }
        
        .player-count-display:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 16px var(--shadow-medium);
        }
        
        .current-count {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }
        
        .count-label {
            display: block;
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Role distribution styling */
        .role-distribution {
            margin: 20px 0;
        }

        .role-distribution h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .role-info {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--card-shadow);
        }

        .role-distribution-compact {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 100%;
        }

        .role-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 12px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            box-shadow: var(--card-shadow);
        }

        .role-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .role-item.liberal {
            border-color: #28a745;
            color: #155724;
        }

        .role-item.fascist {
            border-color: #dc3545;
            color: #721c24;
        }

        .role-item.hitler {
            border-color: #6f42c1;
            color: #4a148c;
        }

        .role-icon {
            width: 2rem;
            height: 2rem;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
        }

        .role-item.liberal .role-icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2328a745'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E");
        }

        .role-item.fascist .role-icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23dc3545'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E");
        }

        .role-item.hitler .role-icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236f42c1'%3E%3Cpath d='M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z'/%3E%3C/svg%3E");
        }

        .role-details {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
            flex: 1;
        }

        .role-name {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .role-stats {
            font-size: 0.75rem;
            font-weight: 500;
            opacity: 0.8;
        }

        /* Player inputs styling */
        .player-inputs {
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .player-input-group {
            margin-bottom: 15px;
        }

        .player-input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .player-name-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--input-text);
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .player-name-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--shadow-light);
            transform: translateY(-1px);
        }

        /* Setup actions */
        .setup-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            font-family: 'Inter', sans-serif;
            box-shadow: var(--card-shadow);
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: var(--text-light);
            border-color: var(--primary-color);
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-hover);
            border-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-medium);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: var(--text-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-medium);
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .player-count-controls {
                gap: 15px;
            }

            .player-btn {
                width: 3.5rem;
                height: 3.5rem;
                font-size: 1.3rem;
            }

            .player-count-display {
                font-size: 1.3rem;
                min-width: 100px;
            }

            .setup-actions {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }

            .role-distribution-compact .role-icon {
                width: 1.5rem;
                height: 1.5rem;
            }
        }

        /* Desktop Layout - Side by side cards for wider screens */
        @media (min-width: 768px) {
            .role-distribution-compact {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
                max-width: 800px;
                margin-left: auto;
                margin-right: auto;
            }
            
            .role-distribution-compact .role-item {
                flex-direction: column;
                text-align: center;
                padding: 1.25rem;
                min-height: 120px;
                justify-content: center;
                gap: 0.75rem;
            }
            
            .role-distribution-compact .role-icon {
                width: 3rem;
                height: 3rem;
            }
            
            .role-distribution-compact .role-details {
                align-items: center;
                gap: 0.5rem;
            }
            
            .role-distribution-compact .role-name {
                font-size: 1rem;
                margin-bottom: 0.25rem;
            }
            
            .role-distribution-compact .role-stats {
                font-size: 1.25rem;
                font-weight: 600;
            }
        }

        /* Enhanced setup sections with modern design */
        .enhanced-section {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            margin: 1.5rem 0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .enhanced-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
            border-color: var(--primary-color);
        }
        
        .enhanced-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .enhanced-section:hover::before {
            transform: scaleX(1);
        }
        
        /* Section headers with icons */
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }
        
        .section-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }
        
        .section-header:hover::after {
            width: 100px;
        }
        
        .section-icon {
            font-size: 1.5rem;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }
        
        .section-header:hover .section-icon {
            transform: scale(1.1);
        }
        
        .section-header h3, .section-header h4 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        /* Create/Join/Lobby headers */
        .create-header, .join-header, .lobby-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--accent-bg);
            border-radius: 16px;
            border: 2px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }
        
        .create-header::before, .join-header::before, .lobby-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
        }
        
        .create-icon, .join-icon, .lobby-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            transition: transform 0.3s ease;
        }
        
        .create-header:hover .create-icon, .join-header:hover .join-icon, .lobby-header:hover .lobby-icon {
            transform: scale(1.05);
        }
        
        .create-header h2, .join-header h2, .lobby-header h2 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .create-description, .join-description, .lobby-description {
            margin: 0;
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.6;
            opacity: 0.9;
        }
        
        /* Enhanced player count selector */
        .player-count-selector {
            text-align: center;
            margin: 2rem 0;
        }
        
        .player-count-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }
        
        .player-btn {
            width: 4rem;
            height: 4rem;
            border: 3px solid var(--primary-color);
            background: var(--bg-secondary);
            color: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.5rem;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .player-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .player-btn:hover::before {
            left: 100%;
        }
        
        .player-btn:hover:not(:disabled) {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .player-btn:active:not(:disabled) {
            transform: scale(0.95);
        }
        
        .player-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .player-btn .btn-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .player-btn:hover .btn-icon {
            transform: scale(1.1);
        }
        
        .player-count-display {
            background: var(--bg-tertiary);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            min-width: 120px;
            text-align: center;
        }
        
        .current-count {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
        }
        
        .count-label {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .player-count-range {
            margin-top: 1rem;
        }
        
        .range-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            opacity: 0.8;
        }
        
        /* Enhanced role distribution */
        .role-distribution {
            margin-top: 2rem;
        }
        
        .role-distribution h4 {
            color: var(--text-primary);
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .role-info {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            min-height: 100px;
        }
        
        /* Enhanced player inputs */
        .player-inputs {
            margin-top: 1rem;
        }
        
        .player-input-group {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .player-input-group:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }
        
        .player-input-group label {
            min-width: 100px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        
        .player-name-input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--input-bg);
            color: var(--input-text);
        }
        
        .player-name-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
            transform: translateY(-1px);
        }
        
        /* Enhanced setup actions */
        .setup-actions {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        
        /* Enhanced game info card */
        .game-info-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            margin: 1.5rem 0;
            border: 2px solid var(--border-color);
            text-align: center;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }
        
        .game-info-card h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .game-id-display {
            background: var(--accent-bg);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            border: 2px solid var(--border-color);
        }
        
        .game-id-label {
            display: block;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .game-id-value {
            display: block;
            font-family: monospace;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            letter-spacing: 2px;
        }
        
        .share-text {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
            font-style: italic;
        }
        
        /* Enhanced players list */
        .players-list {
            margin: 2rem 0;
        }
        
        .players-container {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .player-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            border-color: var(--primary-color);
        }
        
        .player-host {
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: white;
            border-color: var(--accent-color);
        }
        
        .player-host span:last-child {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        /* Responsive design improvements */
        @media (max-width: 768px) {
            .enhanced-section {
                padding: 1.5rem;
                margin: 1rem 0;
                border-radius: 12px;
            }
            
            .create-header h2, .join-header h2, .lobby-header h2 {
                font-size: 1.8rem;
            }
            
            .create-description, .join-description, .lobby-description {
                font-size: 1rem;
            }
            
            .create-icon, .join-icon, .lobby-icon {
                font-size: 2.5rem;
            }
            
            .section-header {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
            
            .section-icon {
                min-width: 2.5rem;
                height: 2.5rem;
                font-size: 1.5rem;
            }
            
            .section-header h3, .section-header h4 {
                font-size: 1.3rem;
            }
            
            .player-count-controls {
                gap: 1.5rem;
                flex-wrap: wrap;
            }
            
            .player-btn {
                width: 3.5rem;
                height: 3.5rem;
                font-size: 1.3rem;
            }
            
            .player-count-display {
                padding: 0.875rem 1.25rem;
                min-width: 100px;
            }
            
            .current-count {
                font-size: 1.75rem;
            }
            
            .player-input-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
                padding: 1.25rem;
            }
            
            .player-input-group label {
                min-width: auto;
                font-size: 0.9rem;
            }
            
            .player-name-input {
                width: 100%;
                padding: 0.875rem;
            }
            
            .setup-actions {
                gap: 0.75rem;
            }
            
            .btn-large {
                min-width: 200px;
                padding: 1rem 1.5rem;
            }
            
            .btn-medium {
                min-width: 180px;
                padding: 0.875rem 1.5rem;
            }
            
            .game-info-card {
                padding: 1.5rem;
            }
            
            .game-id-display {
                padding: 1.25rem;
            }
            
            .game-id-value {
                font-size: 1.25rem;
                letter-spacing: 1px;
            }
            
            .player-item {
                padding: 0.875rem 1.25rem;
                flex-direction: column;
                gap: 0.5rem;
                text-align: center;
            }
        }
        
        @media (max-width: 480px) {
            .enhanced-section {
                padding: 1.25rem;
                margin: 0.75rem 0;
                border-radius: 10px;
            }
            
            .create-header h2, .join-header h2, .lobby-header h2 {
                font-size: 1.6rem;
            }
            
            .create-description, .join-description, .lobby-description {
                font-size: 0.95rem;
            }
            
            .create-icon, .join-icon, .lobby-icon {
                font-size: 2rem;
            }
            
            .section-header h3, .section-header h4 {
                font-size: 1.2rem;
            }
            
            .player-count-controls {
                gap: 1rem;
            }
            
            .player-btn {
                width: 3rem;
                height: 3rem;
                font-size: 1.1rem;
                border-width: 2px;
            }
            
            .player-count-display {
                padding: 0.75rem 1rem;
                min-width: 90px;
            }
            
            .current-count {
                font-size: 1.5rem;
            }
            
            .player-input-group {
                padding: 1rem;
            }
            
            .player-input-group label {
                font-size: 0.85rem;
            }
            
            .player-name-input {
                padding: 0.75rem;
                font-size: 0.95rem;
            }
            
            .btn-large {
                min-width: 180px;
                padding: 0.875rem 1.25rem;
                font-size: 1rem;
            }
            
            .btn-medium {
                min-width: 160px;
                padding: 0.75rem 1.25rem;
            }
            
            .game-info-card {
                padding: 1.25rem;
            }
            
            .game-id-display {
                padding: 1rem;
            }
            
            .game-id-value {
                font-size: 1.1rem;
            }
            
            .player-item {
                padding: 0.75rem 1rem;
            }
        }
        
        /* Extra small mobile devices */
        @media (max-width: 360px) {
            .enhanced-section {
                padding: 1rem;
                margin: 0.5rem 0;
            }
            
            .create-header h2, .join-header h2, .lobby-header h2 {
                font-size: 1.5rem;
            }
            
            .player-count-controls {
                gap: 0.75rem;
            }
            
            .player-btn {
                width: 2.75rem;
                height: 2.75rem;
                font-size: 1rem;
            }
            
            .player-count-display {
                padding: 0.625rem 0.875rem;
                min-width: 80px;
            }
            
            .current-count {
                font-size: 1.25rem;
            }
            
            .btn-large {
                min-width: 160px;
                padding: 0.75rem 1rem;
                font-size: 0.95rem;
            }
            
            .btn-medium {
                min-width: 140px;
                padding: 0.625rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Enhanced header styling to match home page */
        header {
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--header-text);
            position: relative;
            z-index: 1;
            padding: 1rem 0;
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--border-color);
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }
        
        .game-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            background: var(--primary-color);
            color: var(--text-light);
            padding: 0.6rem;
            border-radius: 50%;
            border: none;
            animation: none;
            box-shadow: 0 4px 12px var(--shadow-medium);
            transition: all 0.3s ease;
        }
        
        .logo-icon:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px var(--shadow-medium);
        }
        
        .logo-text h1 {
            font-size: 2.2rem;
            margin-bottom: 0.25rem;
            text-shadow: none;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary-color);
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .logo-text h1:hover {
            transform: scale(1.02);
            color: var(--primary-hover);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            font-weight: 400;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }
        
        .header-decoration {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .decoration-line {
            width: 40px;
            height: 2px;
            background: var(--primary-color);
            transition: all 0.3s ease;
        }
        
        .header-decoration:hover .decoration-line {
            background: var(--primary-hover);
            transform: scaleX(1.1);
        }
        
        .decoration-dot {
            width: 6px;
            height: 6px;
            background: var(--primary-color);
            border-radius: 50%;
            animation: none;
            transition: all 0.3s ease;
        }
        
        .header-decoration:hover .decoration-dot {
            background: var(--primary-hover);
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="game-logo">
                    <div class="logo-icon">🎭</div>
                    <div class="logo-text">
                        <h1 id="header-title" style="cursor: pointer;">Secret Hitler</h1>
                        <p class="subtitle" id="page-subtitle">Multi-Device Edition</p>
                    </div>
                </div>
                <div class="header-decoration">
                    <div class="decoration-line"></div>
                    <div class="decoration-dot"></div>
                    <div class="decoration-line"></div>
                </div>
            </div>
        </header>
        
        <main class="multi-device-setup">
            
            <!-- Game Creation Section -->
            <div id="create-section" class="setup-section game-creation active">
                <div class="create-header">
                    <div class="create-icon">🎮</div>
                    <h2>Create New Game</h2>
                    <p class="create-description">Set up a new Secret Hitler game with your preferred player count and names</p>
                </div>

                <div class="setup-section enhanced-section">
                    <div class="section-header">
                        <div class="section-icon">👥</div>
                        <h3>Player Count</h3>
                    </div>
                    <div class="player-count-selector">
                        <div class="player-count-controls">
                            <button class="player-btn player-minus" id="player-minus" disabled>
                                <span class="btn-icon">➖</span>
                            </button>
                            <div class="player-count-display">
                                <span class="current-count">0</span>
                                <span class="count-label">players</span>
                            </div>
                            <button class="player-btn player-plus" id="player-plus">
                                <span class="btn-icon">➕</span>
                            </button>
                        </div>
                        <div class="player-count-range">
                            <span class="range-text">Range: 5-10 players</span>
                        </div>
                    </div>
                    
                    <div class="role-distribution" id="role-distribution-section" style="display: none;">
                        <h4>Role Distribution</h4>
                        <div id="role-info" class="role-info">
                            <!-- Role distribution will be populated here -->
                        </div>
                    </div>
                </div>
                    
                <div class="setup-section enhanced-section" id="player-names-section" style="display: none;">
                    <div class="section-header">
                        <div class="section-icon">✏️</div>
                        <h3>Player Names</h3>
                    </div>
                    <div id="player-inputs" class="player-inputs">
                        <!-- Player input fields will be generated here -->
                    </div>
                </div>
                    
                <div class="setup-actions">
                    <button id="create-game-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">🚀</span>
                        <span class="btn-text">Create Game</span>
                    </button>
                    <button type="button" class="btn btn-outline btn-medium" onclick="window.history.back()">
                        <span class="btn-icon">⬅️</span>
                        <span class="btn-text">Back</span>
                    </button>
                </div>
            </div>
            
            <!-- Game Joining Section -->
            <div id="join-section" class="setup-section game-joining">
                <div class="join-header">
                    <div class="join-icon">🔗</div>
                    <h2>Join Existing Game</h2>
                    <p class="join-description">Enter a Game ID to join an existing Secret Hitler game</p>
                </div>
                
                <form id="join-game-form">
                    <div class="form-group">
                        <label for="game-id-input">Game ID:</label>
                        <input type="text" id="game-id-input" placeholder="Enter game ID" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="player-name-select">Select Your Name:</label>
                        <select id="player-name-select" required>
                            <option value="">Choose your name from the game...</option>
                        </select>
                        <small class="form-help">Available names will load after entering the Game ID</small>
                    </div>
                    
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary btn-large">
                            <span class="btn-icon">🎯</span>
                            <span class="btn-text">Join Game</span>
                        </button>
                        <button type="button" class="btn btn-outline btn-medium" onclick="window.history.back()">
                            <span class="btn-icon">⬅️</span>
                            <span class="btn-text">Back</span>
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Game Lobby Section -->
            <div id="game-lobby" class="setup-section game-lobby">
                <div class="lobby-header">
                    <div class="lobby-icon">🏠</div>
                    <h2>Game Lobby</h2>
                    <p class="lobby-description">Waiting for players to join. Share the Game ID with others!</p>
                </div>
                
                <div id="game-info" class="game-info-card">
                    <h3 id="lobby-game-name"></h3>
                    <div class="game-id-display">
                        <span class="game-id-label">Game ID:</span>
                        <span id="lobby-game-id" class="game-id-value"></span>
                    </div>
                    <p class="share-text">Share this Game ID with other players to join!</p>
                </div>
                
                <div class="players-list">
                    <div class="section-header">
                        <div class="section-icon">👥</div>
                        <h4>Players (<span id="player-count">0</span>/<span id="max-player-count">0</span>)</h4>
                    </div>
                    <div id="players-container" class="players-container">
                        <!-- Players will be populated here -->
                    </div>
                </div>
                
                <div class="btn-group">
                    <button id="start-game-btn" class="btn btn-primary btn-large" style="display: none;">
                        <span class="btn-icon">🚀</span>
                        <span class="btn-text">Start Game</span>
                    </button>
                    <button id="leave-game-btn" class="btn btn-outline btn-medium">
                        <span class="btn-icon">🚪</span>
                        <span class="btn-text">Leave Game</span>
                    </button>
                </div>
            </div>
            
            <!-- Status Messages -->
            <div id="status-container"></div>
        </main>
    </div>
    
    <script>
        class MultiDeviceGame {
            constructor() {
                this.backendUrl = 'http://localhost:8000';
                this.currentGame = null;
                this.currentPlayer = null;
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.setupHeaderNavigation();
                this.autoShowSection();
                this.initializePlayerCount();
            }
            
            initializePlayerCount() {
                // Start with 0 players like pass-and-play
                this.updatePlayerCount(0);
            }
            
            setupHeaderNavigation() {
                // Make the header title clickable to return to home
                const headerTitle = document.getElementById('header-title');
                if (headerTitle) {
                    headerTitle.addEventListener('click', () => {
                        window.location.href = '../index.html';
                    });
                }
            }
            
            setupEventListeners() {
                // Player count +/- buttons
                const minusBtn = document.getElementById('player-minus');
                const plusBtn = document.getElementById('player-plus');
                
                if (minusBtn && plusBtn) {
                    minusBtn.addEventListener('click', () => {
                        const currentCount = this.getCurrentPlayerCount();
                        if (currentCount > 5) {
                            this.updatePlayerCount(currentCount - 1);
                        } else if (currentCount === 5) {
                            this.updatePlayerCount(0);
                        }
                    });
                    
                    plusBtn.addEventListener('click', () => {
                        const currentCount = this.getCurrentPlayerCount();
                        if (currentCount === 0) {
                            this.updatePlayerCount(5);
                        } else if (currentCount < 10) {
                            this.updatePlayerCount(currentCount + 1);
                        }
                    });
                }

                // Create game button
                document.getElementById('create-game-btn').addEventListener('click', () => {
                    this.createGame();
                });
                
                // Join game form
                document.getElementById('join-game-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.joinGame();
                });
                
                // Game ID input - load player names when game ID is entered
                document.getElementById('game-id-input').addEventListener('input', (e) => {
                    const gameId = e.target.value.trim();
                    if (gameId.length >= 3) { // Load names after 3+ characters
                        this.loadAvailablePlayerNames(gameId);
                    } else {
                        this.clearPlayerNamesDropdown();
                    }
                    this.updateJoinButtonState();
                });
                
                // Player name select - update join button state when selection changes
                document.getElementById('player-name-select').addEventListener('change', () => {
                    this.updateJoinButtonState();
                });
                
                // Start game button
                document.getElementById('start-game-btn').addEventListener('click', () => {
                    this.startGame();
                });
                
                // Leave game button
                document.getElementById('leave-game-btn').addEventListener('click', () => {
                    this.leaveGame();
                });
            }
            
            // Load available player names for the specified game
            async loadAvailablePlayerNames(gameId) {
                const formGroup = document.querySelector('#join-section .form-group:last-child');
                const select = document.getElementById('player-name-select');
                const helpText = document.querySelector('.form-help');
                
                try {
                    // Show loading state
                    if (formGroup) formGroup.classList.add('loading');
                    if (helpText) {
                        helpText.textContent = 'Loading available names...';
                        helpText.style.color = 'var(--accent-info)';
                    }
                    
                    const response = await fetch(`${this.backendUrl}/api/games.php?id=${gameId}`);
                    const data = await response.json();
                    
                    if (data.success && data.players) {
                        this.populatePlayerNamesDropdown(data.players);
                    } else {
                        this.clearPlayerNamesDropdown();
                        this.showStatus('Game not found or invalid Game ID', 'error');
                    }
                } catch (error) {
                    console.error('Error loading player names:', error);
                    this.clearPlayerNamesDropdown();
                    if (helpText) {
                        helpText.textContent = 'Error loading player names. Please try again.';
                        helpText.style.color = 'var(--accent-danger)';
                    }
                } finally {
                    // Remove loading state
                    if (formGroup) formGroup.classList.remove('loading');
                }
            }
            
            // Populate the player names dropdown with available names
            populatePlayerNamesDropdown(players) {
                const select = document.getElementById('player-name-select');
                const helpText = document.querySelector('.form-help');
                
                // Clear existing options except the first one
                select.innerHTML = '<option value="">Choose your name from the game...</option>';
                
                // Add player names that haven't been claimed yet
                const availablePlayers = players.filter(player => !player.is_claimed);
                
                if (availablePlayers.length === 0) {
                    // No available names
                    if (helpText) {
                        helpText.textContent = 'All player names have been claimed for this game.';
                        helpText.style.color = 'var(--accent-danger)';
                    }
                    select.disabled = true;
                } else {
                    // Add available names
                    availablePlayers.forEach(player => {
                        const option = document.createElement('option');
                        option.value = player.name;
                        option.textContent = player.name;
                        select.appendChild(option);
                    });
                    
                    if (helpText) {
                        helpText.textContent = `${availablePlayers.length} available name(s) found. Select yours to join!`;
                        helpText.style.color = 'var(--accent-success)';
                    }
                    select.disabled = false;
                }
                
                // Update join button state
                this.updateJoinButtonState();
            }
            
            // Clear the player names dropdown
            clearPlayerNamesDropdown() {
                const select = document.getElementById('player-name-select');
                const helpText = document.querySelector('.form-help');
                
                select.innerHTML = '<option value="">Choose your name from the game...</option>';
                
                if (helpText) {
                    helpText.textContent = 'Available names will load after entering the Game ID';
                    helpText.style.color = 'var(--text-secondary)';
                }
                
                // Update join button state
                this.updateJoinButtonState();
            }
            
            autoShowSection() {
                // Get the mode from URL parameters
                const urlParams = new URLSearchParams(window.location.search);
                const mode = urlParams.get('mode') || 'create';
                
                // Update page subtitle based on mode
                const subtitle = document.getElementById('page-subtitle');
                if (subtitle) {
                    subtitle.textContent = mode === 'create' ? 'Create New Game' : 'Join Existing Game';
                }
                
                // Show the appropriate section based on mode
                this.showSection(mode);
            }
            
            showSection(sectionName) {
                // Hide all sections
                document.querySelectorAll('.setup-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show selected section
                document.getElementById(`${sectionName}-section`).classList.add('active');
            }
            
            getCurrentPlayerCount() {
                const currentCountSpan = document.querySelector('.current-count');
                return currentCountSpan ? parseInt(currentCountSpan.textContent) : 0;
            }
            
            updatePlayerCount(newCount) {
                const currentCount = this.getCurrentPlayerCount();
                
                if (newCount === currentCount) return;
                
                // Update the display
                const countDisplay = document.querySelector('.current-count');
                if (countDisplay) {
                    countDisplay.textContent = newCount;
                }
                
                // Update role distribution and player inputs
                const roleInfo = document.getElementById('role-info');
                const playerInputs = document.getElementById('player-inputs');
                const createGameBtn = document.getElementById('create-game-btn');
                const roleDistributionSection = document.getElementById('role-distribution-section');
                const playerNamesSection = document.getElementById('player-names-section');
                
                if (newCount === 0) {
                    // Hide role distribution and player inputs when count is 0
                    roleInfo.innerHTML = '<p>Select player count to see role distribution</p>';
                    playerInputs.innerHTML = '';
                    createGameBtn.disabled = true;
                    roleDistributionSection.style.display = 'none';
                    playerNamesSection.style.display = 'none';
                    return;
                }

                // Show role distribution and player names sections
                roleDistributionSection.style.display = 'block';
                playerNamesSection.style.display = 'block';
                
                // Update role distribution display - EXACTLY like pass-and-play
                const distribution = this.getRoleDistribution(newCount);
                const liberalPercent = Math.round((distribution.liberals / newCount) * 100);
                const fascistPercent = Math.round((distribution.fascists / newCount) * 100);
                const hitlerPercent = Math.round((distribution.hitler / newCount) * 100);
                
                roleInfo.innerHTML = `
                    <div class="role-distribution-compact">
                        <div class="role-item liberal">
                            <div class="role-icon"></div>
                            <div class="role-details">
                                <span class="role-name">Liberal</span>
                                <span class="role-stats">${distribution.liberals} (${liberalPercent}%)</span>
                            </div>
                        </div>
                        <div class="role-item fascist">
                            <div class="role-icon"></div>
                            <div class="role-details">
                                <span class="role-name">Fascist</span>
                                <span class="role-stats">${distribution.fascists} (${fascistPercent}%)</span>
                            </div>
                        </div>
                        <div class="role-item hitler">
                            <div class="role-icon"></div>
                            <div class="role-details">
                                <span class="role-name">Hitler</span>
                                <span class="role-stats">${distribution.hitler} (${hitlerPercent}%)</span>
                            </div>
                        </div>
                    </div>
                `;

                // Smart player input management - preserve existing names EXACTLY like pass-and-play
                const existingInputs = playerInputs.querySelectorAll('.player-input-group');
                const existingNames = Array.from(existingInputs).map(group => {
                    const input = group.querySelector('.player-name-input');
                    return input ? input.value.trim() : '';
                });
                
                // Clear existing inputs
                playerInputs.innerHTML = '';
                
                // Add new inputs, preserving names where possible
                for (let i = 1; i <= newCount; i++) {
                    const inputGroup = document.createElement('div');
                    inputGroup.className = 'player-input-group';
                    
                    // Preserve existing name if available, otherwise use empty placeholder
                    const existingName = existingNames[i - 1] || '';
                    const placeholder = existingName || `Enter player name`;
                    
                    inputGroup.innerHTML = `
                        <label for="player-${i}">Player ${i}:</label>
                        <input type="text" id="player-${i}" class="player-name-input" 
                               placeholder="${placeholder}" value="${existingName}">
                    `;
                    playerInputs.appendChild(inputGroup);
                }

                // Enable create game button
                createGameBtn.disabled = false;
                
                // Update button states
                const minusBtn = document.getElementById('player-minus');
                const plusBtn = document.getElementById('player-plus');
                
                if (minusBtn) {
                    minusBtn.disabled = newCount <= 5;
                }
                if (plusBtn) {
                    plusBtn.disabled = newCount >= 10;
                }
            }
            
            getRoleDistribution(playerCount) {
                const distributions = {
                    5: { liberals: 3, fascists: 1, hitler: 1 },
                    6: { liberals: 4, fascists: 1, hitler: 1 },
                    7: { liberals: 4, fascists: 2, hitler: 1 },
                    8: { liberals: 5, fascists: 2, hitler: 1 },
                    9: { liberals: 6, fascists: 2, hitler: 1 },
                    10: { liberals: 6, fascists: 3, hitler: 1 }
                };
                return distributions[playerCount] || { liberals: 0, fascists: 0, hitler: 0 };
            }
            
            async createGame() {
                const maxPlayers = this.getCurrentPlayerCount();
                
                // Validate inputs
                if (maxPlayers === 0) {
                    this.showStatus('Please select a player count', 'error');
                    return;
                }
                
                // Collect all player names
                const playerNames = [];
                for (let i = 1; i <= maxPlayers; i++) {
                    const input = document.getElementById(`player-${i}`);
                    const name = input.value.trim();
                    if (!name) {
                        this.showStatus(`Please enter a name for Player ${i}`, 'error');
                        input.focus();
                        return;
                    }
                    playerNames.push(name);
                }
                
                try {
                    this.showStatus('Creating game...', 'info');
                    
                    const response = await fetch(`${this.backendUrl}/api/games.php`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            action: 'create',
                            name: `Secret Hitler Game`,
                            maxPlayers: maxPlayers,
                            playerNames: playerNames
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.currentGame = {
                            id: data.game_id,
                            name: 'Secret Hitler Game',
                            maxPlayers: maxPlayers,
                            playerNames: playerNames
                        };
                        this.currentPlayer = {
                            id: data.host_id,
                            name: playerNames[0], // First player is the host
                            isHost: true
                        };
                        
                        this.showStatus('Game created successfully!', 'success');
                        this.showGameLobby();
                        this.refreshGameInfo();
                    } else {
                        this.showStatus(`Error: ${data.error}`, 'error');
                    }
                    
                } catch (error) {
                    this.showStatus(`Error: ${error.message}`, 'error');
                }
            }
            
            async joinGame() {
                const gameId = document.getElementById('game-id-input').value.trim();
                const playerName = document.getElementById('player-name-select').value;
                
                // Validation
                if (!gameId) {
                    this.showStatus('Please enter a Game ID', 'error');
                    return;
                }
                
                if (!playerName) {
                    this.showStatus('Please select your name from the available options', 'error');
                    return;
                }
                
                try {
                    this.showStatus('Joining game...', 'info');
                    
                    const response = await fetch(`${this.backendUrl}/api/games.php`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            action: 'join',
                            gameId: gameId,
                            playerName: playerName
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.currentGame = { id: gameId };
                        this.currentPlayer = {
                            id: data.player_id,
                            name: playerName,
                            isHost: false
                        };
                        
                        this.showStatus('Joined game successfully!', 'success');
                        this.showGameLobby();
                        this.refreshGameInfo();
                    } else {
                        this.showStatus(`Error: ${data.error}`, 'error');
                    }
                    
                } catch (error) {
                    this.showStatus(`Error: ${error.message}`, 'error');
                }
            }
            
            async refreshGameInfo() {
                if (!this.currentGame) return;
                
                try {
                    const response = await fetch(`${this.backendUrl}/api/games.php?id=${this.currentGame.id}`);
                    const data = await response.json();
                    
                    if (data.success) {
                        this.updateLobbyDisplay(data);
                    }
                } catch (error) {
                    console.error('Error refreshing game info:', error);
                }
            }
            
            updateLobbyDisplay(gameData) {
                // Update game info
                document.getElementById('lobby-game-name').textContent = gameData.game.name;
                document.getElementById('lobby-game-id').textContent = gameData.game.id;
                document.getElementById('player-count').textContent = gameData.game.current_players;
                document.getElementById('max-player-count').textContent = gameData.game.max_players;
                
                // Update players list
                const playersContainer = document.getElementById('players-container');
                playersContainer.innerHTML = '';
                
                gameData.players.forEach(player => {
                    const playerDiv = document.createElement('div');
                    playerDiv.className = `player-item ${player.is_host ? 'player-host' : ''}`;
                    playerDiv.innerHTML = `
                        <span>${player.name}</span>
                        <span>${player.is_host ? '👑 Host' : ''}</span>
                    `;
                    playersContainer.appendChild(playerDiv);
                });
                
                // Show/hide start button for host
                const startBtn = document.getElementById('start-game-btn');
                if (this.currentPlayer.isHost && gameData.game.status === 'lobby') {
                    startBtn.style.display = 'block';
                } else {
                    startBtn.style.display = 'none';
                }
            }
            
            async startGame() {
                if (!this.currentGame || !this.currentPlayer.isHost) return;
                
                try {
                    this.showStatus('Starting game...', 'info');
                    
                    const response = await fetch(`${this.backendUrl}/api/games.php`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            action: 'start',
                            gameId: this.currentGame.id,
                            hostId: this.currentPlayer.id
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.showStatus('Game started! Redirecting to game...', 'success');
                        // TODO: Redirect to game page
                        setTimeout(() => {
                            // For now, just refresh the lobby
                            this.refreshGameInfo();
                        }, 2000);
                    } else {
                        this.showStatus(`Error: ${data.error}`, 'error');
                    }
                    
                } catch (error) {
                    this.showStatus(`Error: ${error.message}`, 'error');
                }
            }
            
            leaveGame() {
                this.currentGame = null;
                this.currentPlayer = null;
                this.hideGameLobby();
                window.history.back();
            }
            
            showGameLobby() {
                document.getElementById('game-lobby').classList.add('active');
                document.getElementById('create-section').classList.remove('active');
                document.getElementById('join-section').classList.remove('active');
            }
            
            hideGameLobby() {
                document.getElementById('game-lobby').classList.remove('active');
            }
            
            showStatus(message, type = 'info') {
                const statusContainer = document.getElementById('status-container');
                const statusDiv = document.createElement('div');
                statusDiv.className = `status-message status-${type}`;
                statusDiv.textContent = message;
                
                statusContainer.appendChild(statusDiv);
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    statusDiv.remove();
                }, 5000);
            }

            updateJoinButtonState() {
                const gameIdInput = document.getElementById('game-id-input');
                const playerNameSelect = document.getElementById('player-name-select');
                const joinBtn = document.querySelector('#join-game-form .btn-primary');

                if (gameIdInput && playerNameSelect && joinBtn) {
                    const gameId = gameIdInput.value.trim();
                    const playerName = playerNameSelect.value;

                    if (gameId.length >= 3 && playerName) {
                        joinBtn.disabled = false;
                    } else {
                        joinBtn.disabled = true;
                    }
                }
            }
        }
        
        // Initialize the multi-device game
        const multiDeviceGame = new MultiDeviceGame();
        
        // Auto-refresh game info every 5 seconds when in lobby
        setInterval(() => {
            if (multiDeviceGame.currentGame) {
                multiDeviceGame.refreshGameInfo();
            }
        }, 5000);
    </script>
</body>
</html>
